-------------------------------------------------------------------------------------------------------------------------------
--    HI Tecnologia Ind. Com. Ltda - www.hitecnologia.com.br
-------------------------------------------------------------------------------------------------------------------------------
--    Projeto: App Model HIscada Pro
--    Cliente: 
--       Data: 01/ago/2013  
--      Resp.: Eng. de Produto da HI Tecnologia
--   Ambiente: HIscada Pro, versão 1.3.03 ou superior
-------------------------------------------------------------------------------------------------------------------------------
--  Descrição: 
--    Script para gerar o Preview de Relatórios da Aplicação em objetos Preview de telas
--
--  Objeto Associado: 
--    Botão XX
-------------------------------------------------------------------------------------------------------------------------------



-------------------------------------------------------------------------------------------------------------------------------
-- Obtém a tela onde está o Preview para o Relatório
-------------------------------------------------------------------------------------------------------------------------------
local scr = Sender.Screen


-------------------------------------------------------------------------------------------------------------------------------
-- Recebe como parâmetro o nome do Preview da tela
-------------------------------------------------------------------------------------------------------------------------------
local NomePreview = Sender.Argument 



-------------------------------------------------------------------------------------------------------------------------------
-- Verifica o argumento recebido
-------------------------------------------------------------------------------------------------------------------------------
if(NomePreview == nil)then
  MessageBox("ERW: Falha na execução do comando!")
  return
end



-------------------------------------------------------------------------------------------------------------------------------
-- Verifica a existência do objeto preview na tela
-------------------------------------------------------------------------------------------------------------------------------
local Preview = scr[NomePreview]
if(Preview == nil)then
  MessageBox("ERW: Falha na execução do comando!")
  return
end
  

-------------------------------------------------------------------------------------------------------------------------------
-- Executa o comando de Preview
-------------------------------------------------------------------------------------------------------------------------------
scr[NomePreview]:ShowReport()

